<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreightMate AU Dashboard</title>
    <!-- Leaflet (Open Source Map) - More reliable alternative -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f39c12;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-role {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
        }

        .controls {
            background: white;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.2s;
        }

        .search-box input:focus {
            border-color: #3b82f6;
        }

        .filter-btn {
            background: #f1f5f9;
            border: 2px solid #e2e8f0;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            background: #e2e8f0;
        }

        .filter-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .main-content {
            display: flex;
            height: calc(100vh - 140px);
            gap: 1rem;
            padding: 1rem 2rem;
        }

        .map-container {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .map-header {
            background: #f8fafc;
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .map-view {
            height: calc(100% - 60px);
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
            border-radius: 0 0 12px 12px;
        }

        .table-container {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .table-header {
            background: #f8fafc;
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-weight: 600;
        }

        .table-stats {
            display: flex;
            gap: 2rem;
            font-size: 0.875rem;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .table-wrapper {
            overflow-y: auto;
            height: calc(100% - 80px);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8fafc;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: #64748b;
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.875rem;
        }

        tr:hover {
            background: #f8fafc;
            cursor: pointer;
        }

        tr.selected {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
        }

        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .status-on-time {
            background: #dcfce7;
            color: #166534;
        }

        .status-delayed {
            background: #fef3c7;
            color: #92400e;
        }

        .status-critical {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-delivered {
            background: #f3f4f6;
            color: #374151;
        }

        .carrier-logo {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: #64748b;
        }

        .map-legend {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            background: rgba(255, 255, 255, 0.95);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.75rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.6; }
            100% { transform: scale(1); opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
                height: auto;
                min-height: calc(100vh - 140px);
            }
            
            .map-container, .table-container {
                min-height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">FreightMate AU</div>
        <div class="user-info">
            <div class="user-role">Logistics Coordinator</div>
            <div>Emma Thompson</div>
        </div>
    </div>

    <div class="controls">
        <div class="search-box">
            <input type="text" placeholder="Search shipments by ID, customer, or destination...">
        </div>
        <button class="filter-btn active" data-filter="all">All Shipments</button>
        <button class="filter-btn" data-filter="in-transit">In Transit</button>
        <button class="filter-btn" data-filter="delayed">Delayed</button>
        <button class="filter-btn" data-filter="critical">Critical</button>
        <div style="border-left: 1px solid #e2e8f0; margin: 0 0.5rem; height: 2rem;"></div>
        <button class="filter-btn" data-filter="nsw">NSW</button>
        <button class="filter-btn" data-filter="vic">VIC</button>
        <button class="filter-btn" data-filter="qld">QLD</button>
        <button class="filter-btn" data-filter="wa">WA</button>
        <button class="filter-btn" data-filter="sa">SA</button>
        <button class="filter-btn" data-filter="tas">TAS</button>
        <button class="filter-btn" data-filter="nt">NT</button>
    </div>

    <div class="main-content">
        <div class="map-container">
            <div class="map-header">
                <div>Australian Freight Routes</div>
                <div style="font-size: 0.75rem; color: #64748b;">Real-time tracking</div>
            </div>
            <div class="map-view">
                <div id="map"></div>
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #10b981;"></div>
                        <span>On Time</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #f59e0b;"></div>
                        <span>Delayed</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #ef4444;"></div>
                        <span>Critical</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: #6b7280;"></div>
                        <span>Delivered</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Active Shipments</div>
                <div class="table-stats">
                    <div class="stat">
                        <div class="stat-dot" style="background: #10b981;"></div>
                        <span>On Time (4)</span>
                    </div>
                    <div class="stat">
                        <div class="stat-dot" style="background: #f59e0b;"></div>
                        <span>Delayed (2)</span>
                    </div>
                    <div class="stat">
                        <div class="stat-dot" style="background: #ef4444;"></div>
                        <span>Critical (1)</span>
                    </div>
                </div>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Shipment ID</th>
                            <th>Customer</th>
                            <th>Origin ‚Üí Destination</th>
                            <th>Carrier</th>
                            <th>Status</th>
                            <th>ETA</th>
                        </tr>
                    </thead>
                    <tbody id="shipmentTable">
                        <tr data-shipment="FM001" data-origin="nsw" data-destination="vic" data-status="on-time">
                            <td><strong>FM001</strong></td>
                            <td>Woolworths Group</td>
                            <td>Sydney ‚Üí Melbourne</td>
                            <td><div class="carrier-logo">TNT</div></td>
                            <td><span class="status-badge status-on-time">On Time</span></td>
                            <td>16 Dec, 2:30 PM</td>
                        </tr>
                        <tr data-shipment="FM002" data-origin="wa" data-destination="sa" data-status="delayed">
                            <td><strong>FM002</strong></td>
                            <td>Bunnings Warehouse</td>
                            <td>Perth ‚Üí Adelaide</td>
                            <td><div class="carrier-logo">STX</div></td>
                            <td><span class="status-badge status-delayed">Delayed</span></td>
                            <td>17 Dec, 11:00 AM</td>
                        </tr>
                        <tr data-shipment="FM003" data-origin="nt" data-destination="qld" data-status="critical">
                            <td><strong>FM003</strong></td>
                            <td>BHP Billiton</td>
                            <td>Darwin ‚Üí Brisbane</td>
                            <td><div class="carrier-logo">LNF</div></td>
                            <td><span class="status-badge status-critical">Critical</span></td>
                            <td>18 Dec, 9:45 AM</td>
                        </tr>
                        <tr data-shipment="FM004" data-origin="vic" data-destination="tas" data-status="on-time">
                            <td><strong>FM004</strong></td>
                            <td>Coles Supermarkets</td>
                            <td>Melbourne ‚Üí Hobart</td>
                            <td><div class="carrier-logo">TNT</div></td>
                            <td><span class="status-badge status-on-time">On Time</span></td>
                            <td>16 Dec, 6:15 PM</td>
                        </tr>
                        <tr data-shipment="FM005" data-origin="qld" data-destination="qld" data-status="delivered">
                            <td><strong>FM005</strong></td>
                            <td>Harvey Norman</td>
                            <td>Brisbane ‚Üí Gold Coast</td>
                            <td><div class="carrier-logo">APX</div></td>
                            <td><span class="status-badge status-delivered">Delivered</span></td>
                            <td>15 Dec, 3:20 PM</td>
                        </tr>
                        <tr data-shipment="FM006" data-origin="sa" data-destination="act" data-status="on-time">
                            <td><strong>FM006</strong></td>
                            <td>Wesfarmers</td>
                            <td>Adelaide ‚Üí Canberra</td>
                            <td><div class="carrier-logo">STX</div></td>
                            <td><span class="status-badge status-on-time">On Time</span></td>
                            <td>17 Dec, 4:30 PM</td>
                        </tr>
                        <tr data-shipment="FM007" data-origin="nsw" data-destination="nsw" data-status="delayed">
                            <td><strong>FM007</strong></td>
                            <td>Telstra Corporation</td>
                            <td>Sydney ‚Üí Newcastle</td>
                            <td><div class="carrier-logo">LNF</div></td>
                            <td><span class="status-badge status-delayed">Delayed</span></td>
                            <td>18 Dec, 1:15 PM</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // =============================================================================
        // FREIGHT MATE AU - LEAFLET MAP INTEGRATION (More Reliable)
        // =============================================================================

        // Australian city coordinates (latitude, longitude for Leaflet)
        const australianCities = {
            'Sydney': [-33.8688, 151.2093],
            'Melbourne': [-37.8136, 144.9631],
            'Brisbane': [-27.4698, 153.0260],
            'Perth': [-31.9505, 115.8605],
            'Adelaide': [-34.9285, 138.6007],
            'Darwin': [-12.4634, 130.8456],
            'Hobart': [-42.8821, 147.3272],
            'Newcastle': [-32.9267, 151.7817],
            'Gold Coast': [-28.0167, 153.4000],
            'Canberra': [-35.2809, 149.1300]
        };

        // Shipment data with real Australian routes
        const shipmentData = {
            'FM001': {
                origin: 'Sydney',
                destination: 'Melbourne',
                status: 'on-time',
                progress: 0.65,
                customer: 'Woolworths Group',
                carrier: 'TNT'
            },
            'FM002': {
                origin: 'Perth',
                destination: 'Adelaide',
                status: 'delayed',
                progress: 0.35,
                customer: 'Bunnings Warehouse',
                carrier: 'StarTrack'
            },
            'FM003': {
                origin: 'Darwin',
                destination: 'Brisbane',
                status: 'critical',
                progress: 0.20,
                customer: 'BHP Billiton',
                carrier: 'LineFox'
            },
            'FM004': {
                origin: 'Melbourne',
                destination: 'Hobart',
                status: 'on-time',
                progress: 0.80,
                customer: 'Coles Supermarkets',
                carrier: 'TNT'
            },
            'FM005': {
                origin: 'Brisbane',
                destination: 'Gold Coast',
                status: 'delivered',
                progress: 1.0,
                customer: 'Harvey Norman',
                carrier: 'Australia Post'
            },
            'FM006': {
                origin: 'Adelaide',
                destination: 'Canberra',
                status: 'on-time',
                progress: 0.50,
                customer: 'Wesfarmers',
                carrier: 'StarTrack'
            },
            'FM007': {
                origin: 'Sydney',
                destination: 'Newcastle',
                status: 'delayed',
                progress: 0.40,
                customer: 'Telstra Corporation',
                carrier: 'LineFox'
            }
        };

        let map;
        let routeLines = [];
        let markers = [];

        // Initialize Leaflet map
        function initializeMap() {
            try {
                console.log('üó∫Ô∏è Initializing map...');
                
                // Create map centered on Australia
                map = L.map('map').setView([-25.2744, 133.7751], 5);

                // Add OpenStreetMap tiles (free, no API key required)
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors',
                    maxZoom: 18
                }).addTo(map);

                console.log('‚úÖ Map initialized successfully');
                
                // Add shipments to map
                addShipmentRoutes();
                
            } catch (error) {
                console.error('‚ùå Map initialization failed:', error);
                showMapFallback();
            }
        }

        // Add shipment routes and markers
        function addShipmentRoutes() {
            Object.keys(shipmentData).forEach(shipmentId => {
                const shipment = shipmentData[shipmentId];
                const originCoords = australianCities[shipment.origin];
                const destCoords = australianCities[shipment.destination];
                
                if (originCoords && destCoords) {
                    // Add route line
                    addRouteLine(shipmentId, shipment, originCoords, destCoords);
                    
                    // Add markers
                    addShipmentMarkers(shipmentId, shipment, originCoords, destCoords);
                }
            });
            
            console.log(`üìç Added ${Object.keys(shipmentData).length} shipment routes`);
        }

        // Add route line between cities
        function addRouteLine(shipmentId, shipment, originCoords, destCoords) {
            const routeColor = getStatusColor(shipment.status);
            
            const routeLine = L.polyline([originCoords, destCoords], {
                color: routeColor,
                weight: 4,
                opacity: 0.8,
                smoothFactor: 1
            }).addTo(map);
            
            routeLine.bindPopup(`
                <div style="padding: 8px;">
                    <strong>${shipmentId}</strong><br>
                    <strong>Route:</strong> ${shipment.origin} ‚Üí ${shipment.destination}<br>
                    <strong>Customer:</strong> ${shipment.customer}<br>
                    <strong>Status:</strong> ${shipment.status.replace('-', ' ').toUpperCase()}
                </div>
            `);
            
            routeLines.push(routeLine);
        }

        // Add markers for origin, destination, and current position
        function addShipmentMarkers(shipmentId, shipment, originCoords, destCoords) {
            // Origin marker
            const originIcon = createCustomIcon('origin', shipment.status);
            const originMarker = L.marker(originCoords, { icon: originIcon })
                .addTo(map)
                .bindPopup(`
                    <div style="padding: 8px;">
                        <strong>${shipmentId} - Origin</strong><br>
                        <strong>From:</strong> ${shipment.origin}<br>
                        <strong>Customer:</strong> ${shipment.customer}<br>
                        <strong>Carrier:</strong> ${shipment.carrier}
                    </div>
                `);

            // Destination marker
            const destIcon = createCustomIcon('destination', shipment.status);
            const destMarker = L.marker(destCoords, { icon: destIcon })
                .addTo(map)
                .bindPopup(`
                    <div style="padding: 8px;">
                        <strong>${shipmentId} - Destination</strong><br>
                        <strong>To:</strong> ${shipment.destination}<br>
                        <strong>Customer:</strong> ${shipment.customer}<br>
                        <strong>Status:</strong> ${shipment.status.replace('-', ' ').toUpperCase()}
                    </div>
                `);

            // Current position marker (if in transit)
            if (shipment.progress < 1.0) {
                const currentLat = originCoords[0] + (destCoords[0] - originCoords[0]) * shipment.progress;
                const currentLng = originCoords[1] + (destCoords[1] - originCoords[1]) * shipment.progress;
                
                const currentIcon = createCustomIcon('current', shipment.status);
                const currentMarker = L.marker([currentLat, currentLng], { icon: currentIcon })
                    .addTo(map)
                    .bindPopup(`
                        <div style="padding: 8px;">
                            <strong>${shipmentId} - Current Location</strong><br>
                            <strong>Route:</strong> ${shipment.origin} ‚Üí ${shipment.destination}<br>
                            <strong>Progress:</strong> ${Math.round(shipment.progress * 100)}%<br>
                            <strong>Status:</strong> ${shipment.status.replace('-', ' ').toUpperCase()}<br>
                            <strong>Customer:</strong> ${shipment.customer}
                        </div>
                    `);
                
                markers.push(currentMarker);
            }
            
            markers.push(originMarker, destMarker);
        }

        // Create custom icons for different marker types
        function createCustomIcon(type, status) {
            const color = getStatusColor(status);
            const size = type === 'current' ? 16 : 12;
            
            const iconHtml = `
                <div style="
                    width: ${size}px;
                    height: ${size}px;
                    background: ${color};
                    border: 2px solid white;
                    border-radius: 50%;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                    ${type === 'current' ? 'animation: pulse 2s infinite;' : ''}
                "></div>
            `;
            
            return L.divIcon({
                html: iconHtml,
                className: 'custom-marker',
                iconSize: [size + 4, size + 4],
                iconAnchor: [(size + 4) / 2, (size + 4) / 2]
            });
        }

        // Get color based on status
        function getStatusColor(status) {
            switch(status) {
                case 'on-time': return '#10b981';
                case 'delayed': return '#f59e0b';
                case 'critical': return '#ef4444';
                case 'delivered': return '#6b7280';
                default: return '#3b82f6';
            }
        }

        // Focus map on specific shipment route
        function focusOnShipment(shipmentId) {
            const shipment = shipmentData[shipmentId];
            if (shipment && map) {
                const originCoords = australianCities[shipment.origin];
                const destCoords = australianCities[shipment.destination];
                
                if (originCoords && destCoords) {
                    // Create bounds that include both cities
                    const group = new L.featureGroup([
                        L.marker(originCoords),
                        L.marker(destCoords)
                    ]);
                    
                    map.fitBounds(group.getBounds().pad(0.1), {
                        duration: 1
                    });
                }
            }
        }

        // Fallback if map fails to load
        function showMapFallback() {
            const mapContainer = document.getElementById('map');
            mapContainer.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%); color: #64748b; text-align: center; padding: 2rem; border-radius: 0 0 12px 12px;">
                    <div>
                        <div style="font-size: 2rem; margin-bottom: 1rem;">üó∫Ô∏è</div>
                        <h3 style="margin-bottom: 0.5rem;">Map Loading...</h3>
                        <p>Interactive Australian freight routes will appear here</p>
                        <p style="margin-top: 1rem; font-size: 0.875rem; opacity: 0.7;">Showing real-time shipment tracking across Australia</p>
                    </div>
                </div>
            `;
        }

        // =============================================================================
        // TABLE INTERACTIONS
        // =============================================================================

        const shipmentRows = document.querySelectorAll('tr[data-shipment]');

        // Handle table row clicks
        shipmentRows.forEach(row => {
            row.addEventListener('click', function() {
                // Remove previous selection
                shipmentRows.forEach(r => r.classList.remove('selected'));
                
                // Add selection to current row
                this.classList.add('selected');
                
                // Get shipment ID and focus map
                const shipmentId = this.dataset.shipment;
                focusOnShipment(shipmentId);
                
                console.log(`Selected shipment: ${shipmentId}`);
            });
        });

        // =============================================================================
        // FILTER FUNCTIONALITY
        // =============================================================================

        const filterButtons = document.querySelectorAll('.filter-btn');
        
        filterButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                // Update active button
                filterButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const filterType = this.dataset.filter;
                applyFilter(filterType);
            });
        });

        function applyFilter(filterType) {
            shipmentRows.forEach(row => {
                let shouldShow = true;
                
                if (filterType === 'all') {
                    shouldShow = true;
                } else if (filterType === 'in-transit') {
                    shouldShow = row.dataset.status === 'on-time';
                } else if (filterType === 'delayed') {
                    shouldShow = row.dataset.status === 'delayed';
                } else if (filterType === 'critical') {
                    shouldShow = row.dataset.status === 'critical';
                } else if (['nsw', 'vic', 'qld', 'wa', 'sa', 'tas', 'nt', 'act'].includes(filterType)) {
                    shouldShow = row.dataset.origin === filterType || row.dataset.destination === filterType;
                }
                
                row.style.display = shouldShow ? '' : 'none';
            });
            
            updateStats();
        }

        function updateStats() {
            const visibleRows = Array.from(shipmentRows).filter(row => row.style.display !== 'none');
            const onTime = visibleRows.filter(row => row.dataset.status === 'on-time').length;
            const delayed = visibleRows.filter(row => row.dataset.status === 'delayed').length;
            const critical = visibleRows.filter(row => row.dataset.status === 'critical').length;
            
            document.querySelector('.table-stats').innerHTML = `
                <div class="stat">
                    <div class="stat-dot" style="background: #10b981;"></div>
                    <span>On Time (${onTime})</span>
                </div>
                <div class="stat">
                    <div class="stat-dot" style="background: #f59e0b;"></div>
                    <span>Delayed (${delayed})</span>
                </div>
                <div class="stat">
                    <div class="stat-dot" style="background: #ef4444;"></div>
                    <span>Critical (${critical})</span>
                </div>
            `;
        }

        // =============================================================================
        // SEARCH FUNCTIONALITY
        // =============================================================================

        const searchInput = document.querySelector('.search-box input');
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            shipmentRows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
            updateStats();
        });

        // =============================================================================
        // REFRESH FUNCTIONALITY
        // =============================================================================

        function addRefreshButton() {
            const refreshBtn = document.createElement('button');
            refreshBtn.className = 'filter-btn';
            refreshBtn.innerHTML = 'üîÑ Refresh Data';
            refreshBtn.style.marginLeft = 'auto';
            refreshBtn.addEventListener('click', function() {
                console.log('üîÑ Refreshing shipment data...');
                
                // Simulate data refresh
                this.innerHTML = '‚è≥ Refreshing...';
                this.disabled = true;
                
                setTimeout(() => {
                    this.innerHTML = 'üîÑ Refresh Data';
                    this.disabled = false;
                    console.log('‚úÖ Data refreshed');
                    
                    // Show notification
                    showNotification('Shipment data updated from carriers');
                }, 1500);
            });
            
            document.querySelector('.controls').appendChild(refreshBtn);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                font-size: 0.875rem;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            // Add slide-in animation
            const styleSheet = document.createElement('style');
            styleSheet.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(styleSheet);
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // =============================================================================
        // INITIALIZE DASHBOARD
        // =============================================================================

        function initializeDashboard() {
            console.log('üöÄ FreightMate AU Dashboard initializing...');
            
            // Initialize map
            initializeMap();
            
            // Add refresh button
            addRefreshButton();
            
            // Set update time
            const mapHeader = document.querySelector('.map-header div:last-child');
            mapHeader.textContent = `Last updated: ${new Date().toLocaleTimeString('en-AU')}`;
            
            console.log('‚úÖ Dashboard ready');
        }

        // Start when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);

        // Handle window resize
        window.addEventListener('resize', function() {
            if (map) {
                map.resize();
            }
        });
    </script>
</body>
</html>
